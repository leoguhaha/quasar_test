var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));

// src-electron/electron-main.js
var import_electron = require("electron");
var import_path = __toESM(require("path"));
var import_os = __toESM(require("os"));
var import_node_rtsp_stream = __toESM(require("node-rtsp-stream"));
var import_mqtt = __toESM(require("mqtt"));
var platform = process.platform || import_os.default.platform();
var mainWindow;
function createWindow() {
  mainWindow = new import_electron.BrowserWindow({
    icon: import_path.default.resolve(__dirname, "icons/icon.png"),
    width: 1e3,
    height: 600,
    fullscreen: false,
    useContentSize: true,
    webPreferences: {
      contextIsolation: true,
      preload: import_path.default.resolve(__dirname, "D:\\QuasarProject\\quasar-project\\.quasar\\electron\\electron-preload.js")
    }
  });
  mainWindow.loadURL("http://localhost:9300");
  if (true) {
    mainWindow.webContents.openDevTools();
  } else {
    mainWindow.webContents.on("devtools-opened", () => {
      mainWindow.webContents.closeDevTools();
    });
  }
  mainWindow.on("closed", () => {
    mainWindow = null;
  });
}
import_electron.app.whenReady().then(createWindow);
import_electron.app.on("window-all-closed", () => {
  if (platform !== "darwin") {
    import_electron.app.quit();
  }
});
import_electron.app.on("activate", () => {
  if (mainWindow === null) {
    console.log("mainWindow is null");
    createWindow();
  }
});
var rtspOpenders = {};
var addPort = 9e3;
import_electron.ipcMain.on("openRtsp", (event, rtsp) => {
  if (rtspOpenders[rtsp]) {
    event.returnValue = {
      code: 200,
      msg: "\u5F00\u542F\u6210\u529F",
      ws: rtspOpenders[rtsp].ws
    };
  } else {
    addPort++;
    const stream = new import_node_rtsp_stream.default({
      name: `socket-${addPort}`,
      streamUrl: rtsp,
      wsPort: addPort,
      ffmpegOptions: {
        "-stats": "",
        "-r": 20,
        "-s": "640x480",
        "-preset": "ultrafast",
        "-tune": "zerolatency",
        "-loglevel": "quiet",
        "-nostats": ""
      }
    }).on("exitWithError", () => {
      stream.stop();
      delete rtspOpenders[rtsp];
      event.returnValue = {
        code: 400,
        msg: "\u5F00\u542F\u5931\u8D25"
      };
    });
    rtspOpenders[rtsp] = {
      ws: `ws://localhost:${addPort}`,
      stream
    };
    event.returnValue = {
      code: 200,
      msg: "\u5F00\u542F\u6210\u529F",
      ws: rtspOpenders[rtsp].ws
    };
  }
});
import_electron.ipcMain.on("stopRtsp", (event, rtsp) => {
  if (rtspOpenders[rtsp]) {
    rtspOpenders[rtsp].stream.stop();
    delete rtspOpenders[rtsp];
  }
});
var mqttClients = [];
var globalSubscribers = /* @__PURE__ */ new Map();
var initMqttClients = () => {
  const brokers = ["mqtt://10.10.0.195:1883", "mqtt://10.10.3.16:1883"];
  for (const broker of brokers) {
    const client = import_mqtt.default.connect(broker);
    mqttClients.push(client);
    client.on("connect", () => {
      console.log(`Connected to MQTT broker at ${broker}`);
      globalSubscribers.forEach((_, topic) => {
        client.subscribe(topic);
      });
    });
    client.on("message", (topic, message) => {
      if (!message)
        return;
      const subscribers = globalSubscribers.get(topic);
      if (subscribers) {
        subscribers.forEach((winId) => {
          const win = import_electron.BrowserWindow.fromId(winId);
          if (win) {
            win.webContents.send("message", topic, message.toString());
          }
        });
      }
    });
    client.on("offline", () => {
      console.log(`Disconnected from MQTT broker at ${broker}`);
    });
    client.on("reconnect", () => {
      console.log(`Reconnecting to MQTT broker at ${broker}...`);
      globalSubscribers.forEach((_, topic) => {
        client.subscribe(topic);
      });
    });
  }
};
initMqttClients();
import_electron.ipcMain.on("subscribe", (event, topic) => {
  const winId = event.sender.id;
  if (!globalSubscribers.has(topic)) {
    globalSubscribers.set(topic, /* @__PURE__ */ new Set());
    mqttClients.forEach((client) => client.subscribe(topic));
  }
  globalSubscribers.get(topic).add(winId);
});
import_electron.ipcMain.on("unsubscribe", (event, topic) => {
  const winId = event.sender.id;
  if (globalSubscribers.has(topic)) {
    const subscribers = globalSubscribers.get(topic);
    subscribers.delete(winId);
    if (subscribers.size === 0) {
      globalSubscribers.delete(topic);
      mqttClients.forEach((client) => client.unsubscribe(topic));
    }
  }
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vc3JjLWVsZWN0cm9uL2VsZWN0cm9uLW1haW4uanMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIi8vIGltcG9ydCB7XG4vLyAgIGFwcCxcbi8vICAgQnJvd3NlcldpbmRvdyxcbi8vICAgY29udGV4dEJyaWRnZSxcbi8vICAgaXBjUmVuZGVyZXIsXG4vLyAgIHNoZWxsLFxuLy8gfSBmcm9tIFwiZWxlY3Ryb25cIjtcbi8vIGltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG4vLyBpbXBvcnQgb3MgZnJvbSBcIm9zXCI7XG4vLyAvLyBcdTU3MjhcdTY1ODdcdTRFRjZcdTk4NzZcdTkwRThcdTVCRkNcdTUxNjVcdTZBMjFcdTU3NTdcbi8vIGltcG9ydCBTdHJlYW0gZnJvbSBcIm5vZGUtcnRzcC1zdHJlYW1cIjtcbi8vIGltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gXCJ1dWlkXCI7XG4vLyBpbXBvcnQgeyBpcGNNYWluIH0gZnJvbSBcImVsZWN0cm9uXCI7XG4vLyBpbXBvcnQgbXF0dCBmcm9tIFwibXF0dFwiO1xuLy8gaW1wb3J0IGZzIGZyb20gXCJmc1wiO1xuXG4vLyAvLyBcdThCRkJcdTUzRDZcdTkxNERcdTdGNkVcdTY1ODdcdTRFRjZcdUZGMENjb25maWcuanNvblxuLy8gY29uc3QgY29uZmlnID0gSlNPTi5wYXJzZShcbi8vICAgZnMucmVhZEZpbGVTeW5jKHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsIFwiY29uZmlnLmpzb25cIiksIFwidXRmOFwiKVxuLy8gKTtcblxuLy8gLy8gbmVlZGVkIGluIGNhc2UgcHJvY2VzcyBpcyB1bmRlZmluZWQgdW5kZXIgTGludXhcbi8vIGNvbnN0IHBsYXRmb3JtID0gcHJvY2Vzcy5wbGF0Zm9ybSB8fCBvcy5wbGF0Zm9ybSgpO1xuXG4vLyBsZXQgbWFpbldpbmRvdztcblxuLy8gZnVuY3Rpb24gY3JlYXRlV2luZG93KCkge1xuLy8gICAvKipcbi8vICAgICogSW5pdGlhbCB3aW5kb3cgb3B0aW9uc1xuLy8gICAgKi9cbi8vICAgbWFpbldpbmRvdyA9IG5ldyBCcm93c2VyV2luZG93KHtcbi8vICAgICBpY29uOiBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBcImljb25zL2ljb24ucG5nXCIpLCAvLyB0cmF5IGljb25cbi8vICAgICB3aWR0aDogMTAwMCxcbi8vICAgICBoZWlnaHQ6IDYwMCxcbi8vICAgICBmdWxsc2NyZWVuOiBmYWxzZSwgLy8gXHU2REZCXHU1MkEwXHU2QjY0XHU4ODRDXHU0RUUzXHU3ODAxXG4vLyAgICAgdXNlQ29udGVudFNpemU6IHRydWUsXG4vLyAgICAgd2ViUHJlZmVyZW5jZXM6IHtcbi8vICAgICAgIGNvbnRleHRJc29sYXRpb246IHRydWUsXG4vLyAgICAgICAvLyBNb3JlIGluZm86IGh0dHBzOi8vdjIucXVhc2FyLmRldi9xdWFzYXItY2xpLXdlYnBhY2svZGV2ZWxvcGluZy1lbGVjdHJvbi1hcHBzL2VsZWN0cm9uLXByZWxvYWQtc2NyaXB0XG4vLyAgICAgICBwcmVsb2FkOiBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBwcm9jZXNzLmVudi5RVUFTQVJfRUxFQ1RST05fUFJFTE9BRCksXG4vLyAgICAgfSxcbi8vICAgfSk7XG5cbi8vICAgbWFpbldpbmRvdy5sb2FkVVJMKHByb2Nlc3MuZW52LkFQUF9VUkwpO1xuXG4vLyAgIGlmIChwcm9jZXNzLmVudi5ERUJVR0dJTkcpIHtcbi8vICAgICAvLyBpZiBvbiBERVYgb3IgUHJvZHVjdGlvbiB3aXRoIGRlYnVnIGVuYWJsZWRcbi8vICAgICBtYWluV2luZG93LndlYkNvbnRlbnRzLm9wZW5EZXZUb29scygpO1xuLy8gICB9IGVsc2Uge1xuLy8gICAgIC8vIHdlJ3JlIG9uIHByb2R1Y3Rpb247IG5vIGFjY2VzcyB0byBkZXZ0b29scyBwbHNcbi8vICAgICBtYWluV2luZG93LndlYkNvbnRlbnRzLm9uKFwiZGV2dG9vbHMtb3BlbmVkXCIsICgpID0+IHtcbi8vICAgICAgIG1haW5XaW5kb3cud2ViQ29udGVudHMuY2xvc2VEZXZUb29scygpO1xuLy8gICAgIH0pO1xuLy8gICB9XG5cbi8vICAgbWFpbldpbmRvdy5vbihcImNsb3NlZFwiLCAoKSA9PiB7XG4vLyAgICAgbWFpbldpbmRvdyA9IG51bGw7XG4vLyAgIH0pO1xuLy8gfVxuXG4vLyBhcHAud2hlblJlYWR5KCkudGhlbihjcmVhdGVXaW5kb3cpO1xuXG4vLyBhcHAub24oXCJ3aW5kb3ctYWxsLWNsb3NlZFwiLCAoKSA9PiB7XG4vLyAgIGlmIChwbGF0Zm9ybSAhPT0gXCJkYXJ3aW5cIikge1xuLy8gICAgIGFwcC5xdWl0KCk7XG4vLyAgIH1cbi8vIH0pO1xuXG4vLyBhcHAub24oXCJhY3RpdmF0ZVwiLCAoKSA9PiB7XG4vLyAgIGlmIChtYWluV2luZG93ID09PSBudWxsKSB7XG4vLyAgICAgY29uc29sZS5sb2coXCJtYWluV2luZG93IGlzIG51bGxcIik7XG4vLyAgICAgY3JlYXRlV2luZG93KCk7XG4vLyAgIH1cbi8vIH0pO1xuXG4vLyBjb25zdCBydHNwT3BlbmRlcnMgPSB7fTtcbi8vIGxldCBhZGRQb3J0ID0gOTAwMDtcblxuLy8gLy8gXHU4QkJFXHU3RjZFaXBjTWFpblx1NzY4NFx1NzZEMVx1NTQyQ1x1NTY2OFx1NTkwNFx1NzQwNlx1NTQwQ1x1NkI2NVx1NkQ4OFx1NjA2RlxuLy8gaXBjTWFpbi5vbihcIm9wZW5SdHNwXCIsIChldmVudCwgcnRzcCwgaXNIaWdoUXVhbGl0eSA9IGZhbHNlKSA9PiB7XG4vLyAgIC8qKiBcdTUyMjRcdTY1QURcdTY2MkZcdTU0MjZcdTVERjJcdTVGMDBcdTU0MkYsXHU4MkU1XHU1REYyXHU1RjAwXHU1NDJGLFx1NzZGNFx1NjNBNVx1OEZENFx1NTZERXdzXHU1NzMwXHU1NzQwLCBcdTY3MkFcdTVGMDBcdTU0MkZcdTUyMTlcdTUxNDhcdTVGMDBcdTU0MkZcdTUxOERcdThGRDRcdTU2REUgKi9cbi8vICAgY29uc29sZS5sb2coXCJvcGVuUnRzcFwiLCBydHNwKTtcbi8vICAgaWYgKHJ0c3BPcGVuZGVyc1tydHNwXSkge1xuLy8gICAgIGV2ZW50LnJldHVyblZhbHVlID0ge1xuLy8gICAgICAgY29kZTogMjAwLFxuLy8gICAgICAgbXNnOiBcIlx1NUYwMFx1NTQyRlx1NjIxMFx1NTI5RlwiLFxuLy8gICAgICAgd3M6IHJ0c3BPcGVuZGVyc1tydHNwXS53cyxcbi8vICAgICB9O1xuLy8gICB9IGVsc2Uge1xuLy8gICAgIGFkZFBvcnQrKztcbi8vICAgICBjb25zdCBzdHJlYW0gPSBuZXcgU3RyZWFtKHtcbi8vICAgICAgIG5hbWU6IGBzb2NrZXQtJHthZGRQb3J0fWAsXG4vLyAgICAgICBzdHJlYW1Vcmw6IHJ0c3AsXG4vLyAgICAgICB3c1BvcnQ6IGFkZFBvcnQsXG4vLyAgICAgICAvLyBmZm1wZWdQYXRoOiBjb25maWcuZmZtcGVnUGF0aCxcbi8vICAgICAgIGZmbXBlZ09wdGlvbnM6IHtcbi8vICAgICAgICAgXCItc3RhdHNcIjogXCJcIixcbi8vICAgICAgICAgXCItclwiOiAyMCxcbi8vICAgICAgICAgXCItc1wiOiBcIjMyMHgyNDBcIixcbi8vICAgICAgICAgXCItcHJlc2V0XCI6IFwidWx0cmFmYXN0XCIsXG4vLyAgICAgICAgIFwiLXR1bmVcIjogXCJ6ZXJvbGF0ZW5jeVwiLFxuLy8gICAgICAgICBcIi1sb2dsZXZlbFwiOiBcInF1aWV0XCIsICAvLyBcdTRFMERcdTY2M0VcdTc5M0FmZm1wZWdcdTc2ODRcdTY1RTVcdTVGRDdcdTRGRTFcdTYwNkZcbi8vICAgICAgICAgXCItbm9zdGF0c1wiOiBcIlwiLCAgLy8gXHU0RTBEXHU2NjNFXHU3OTNBZmZtcGVnXHU3Njg0XHU3RURGXHU4QkExXHU0RkUxXHU2MDZGXG4vLyAgICAgICB9LFxuLy8gICAgIH0pLm9uKFwiZXhpdFdpdGhFcnJvclwiLCAoKSA9PiB7XG4vLyAgICAgICBzdHJlYW0uc3RvcCgpO1xuLy8gICAgICAgZGVsZXRlIHJ0c3BPcGVuZGVyc1tydHNwXTtcbi8vICAgICAgIGV2ZW50LnJldHVyblZhbHVlID0ge1xuLy8gICAgICAgICBjb2RlOiA0MDAsXG4vLyAgICAgICAgIG1zZzogXCJcdTVGMDBcdTU0MkZcdTU5MzFcdThEMjVcIixcbi8vICAgICAgIH07XG4vLyAgICAgfSk7XG4vLyAgICAgcnRzcE9wZW5kZXJzW3J0c3BdID0ge1xuLy8gICAgICAgd3M6IGB3czovL2xvY2FsaG9zdDoke2FkZFBvcnR9YCxcbi8vICAgICAgIHN0cmVhbTogc3RyZWFtLFxuLy8gICAgIH07XG4vLyAgICAgZXZlbnQucmV0dXJuVmFsdWUgPSB7XG4vLyAgICAgICBjb2RlOiAyMDAsXG4vLyAgICAgICBtc2c6IFwiXHU1RjAwXHU1NDJGXHU2MjEwXHU1MjlGXCIsXG4vLyAgICAgICB3czogcnRzcE9wZW5kZXJzW3J0c3BdLndzLFxuLy8gICAgIH07XG4vLyAgIH1cbi8vIH0pO1xuXG4vLyBpcGNNYWluLm9uKFwic3RvcFJ0c3BcIiwgKGV2ZW50LCBydHNwKSA9PiB7XG4vLyAgIGlmIChydHNwT3BlbmRlcnNbcnRzcF0pIHtcbi8vICAgICBydHNwT3BlbmRlcnNbcnRzcF0uc3RyZWFtLnN0b3AoKTtcbi8vICAgICBkZWxldGUgcnRzcE9wZW5kZXJzW3J0c3BdO1xuLy8gICB9XG4vLyB9KTtcblxuLy8gLy8gXHU1MjFCXHU1RUZBXHU0RTAwXHU0RTJBIE1RVFQgXHU1QkEyXHU2MjM3XHU3QUVGXG4vLyBjb25zdCBjbGllbnQgPSBtcXR0LmNvbm5lY3QoXCJtcXR0Oi8vMTAuMTAuMC4xOTU6MTg4M1wiKTtcbi8vIC8vIGNvbnN0IGNsaWVudCA9IG1xdHQuY29ubmVjdChcIm1xdHQ6Ly8xMC4xMC42LjI0MzoxODgzXCIpO1xuXG4vLyAvLyBcdTVCNThcdTUwQThcdThCQTJcdTk2MDVcdTc2ODRcdTRFM0JcdTk4OThcdTU0OENcdTVCODNcdTRFRUNcdTc2ODRcdTU2REVcdThDMDNcdTUxRkRcdTY1NzBcbi8vIGNvbnN0IHRvcGljcyA9IG5ldyBNYXAoKTtcblxuLy8gLy8gXHU1RjUzIE1RVFQgXHU1QkEyXHU2MjM3XHU3QUVGXHU4RkRFXHU2M0E1XHU1MjMwXHU2NzBEXHU1MkExXHU1NjY4XHU2NUY2XG4vLyBjbGllbnQub24oXCJjb25uZWN0XCIsICgpID0+IHtcbi8vICAgY29uc29sZS5sb2coXCJDb25uZWN0ZWQgdG8gTVFUVCBicm9rZXIuXCIpO1xuXG4vLyAgIC8vIFx1OEJGQlx1NTNENlx1OTE0RFx1N0Y2RVx1NjU4N1x1NEVGNlxuLy8gICBjb25zdCBjb25maWcgPSBKU09OLnBhcnNlKFxuLy8gICAgIGZzLnJlYWRGaWxlU3luYyhwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBcIm1xdHQtY29uZmlnLmpzb25cIiksIFwidXRmLThcIilcbi8vICAgKTtcblxuLy8gICAvLyBcdTY4MzlcdTYzNkVcdTkxNERcdTdGNkVcdTY1ODdcdTRFRjZcdThCQkVcdTdGNkUgTVFUVCBcdTVCQTJcdTYyMzdcdTdBRUZcbi8vICAgZm9yIChjb25zdCBpdGVtIG9mIGNvbmZpZykge1xuLy8gICAgIGlmIChpdGVtLnR5cGUgPT09IFwicHVibGlzaFwiKSB7XG4vLyAgICAgICAvLyBcdTU5ODJcdTY3OUNcdTY2MkZcdTUzRDFcdTVFMDNcdTRFM0JcdTk4OThcdUZGMENcdTUyMUJcdTVFRkFcdTRFMDBcdTRFMkFcdTUzRDFcdTVFMDNcdTU2Njhcbi8vICAgICAgIHRvcGljcy5zZXQoaXRlbS50b3BpYywgW1xuLy8gICAgICAgICAobWVzc2FnZSkgPT4gY2xpZW50LnB1Ymxpc2goaXRlbS50b3BpYywgbWVzc2FnZSksXG4vLyAgICAgICBdKTtcbi8vICAgICB9IGVsc2UgaWYgKGl0ZW0udHlwZSA9PT0gXCJzdWJzY3JpYmVcIikge1xuLy8gICAgICAgLy8gXHU1OTgyXHU2NzlDXHU2NjJGXHU4QkEyXHU5NjA1XHU0RTNCXHU5ODk4XHVGRjBDXHU4QkEyXHU5NjA1XHU0RTNCXHU5ODk4XHU1RTc2XHU1QjU4XHU1MEE4XHU1NkRFXHU4QzAzXHU1MUZEXHU2NTcwXG4vLyAgICAgICBjbGllbnQuc3Vic2NyaWJlKGl0ZW0udG9waWMpO1xuLy8gICAgICAgdG9waWNzLnNldChpdGVtLnRvcGljLCBbXSk7XG4vLyAgICAgfVxuLy8gICB9XG4vLyB9KTtcblxuLy8gLy8gXHU1MjFCXHU1RUZBXHU0RTAwXHU0RTJBXHU1QjU4XHU1MEE4XHU4QkEyXHU5NjA1XHU4MDA1XHU3Njg0XHU3RUQzXHU2Nzg0XG4vLyBjb25zdCBzdWJzY3JpYmVycyA9IHt9O1xuXG4vLyBpcGNNYWluLm9uKFwic3Vic2NyaWJlXCIsIChldmVudCwgdG9waWMpID0+IHtcbi8vICAgY29uc3Qgd2luSWQgPSBldmVudC5zZW5kZXIuaWQ7XG4vLyAgIGlmICghc3Vic2NyaWJlcnNbdG9waWNdKSB7XG4vLyAgICAgc3Vic2NyaWJlcnNbdG9waWNdID0gbmV3IFNldCgpO1xuLy8gICAgIGNsaWVudC5zdWJzY3JpYmUodG9waWMpOyAvLyBcdTc4NkVcdTRGRERcdTRFM0JcdTk4OThcdTg4QUJcdThCQTJcdTk2MDVcbi8vICAgfVxuLy8gICBzdWJzY3JpYmVyc1t0b3BpY10uYWRkKHdpbklkKTtcbi8vIH0pO1xuXG4vLyBpcGNNYWluLm9uKFwidW5zdWJzY3JpYmVcIiwgKGV2ZW50LCB0b3BpYykgPT4ge1xuLy8gICBjb25zdCB3aW5JZCA9IGV2ZW50LnNlbmRlci5pZDtcbi8vICAgaWYgKHN1YnNjcmliZXJzW3RvcGljXSkge1xuLy8gICAgIHN1YnNjcmliZXJzW3RvcGljXS5kZWxldGUod2luSWQpO1xuLy8gICAgIGlmIChzdWJzY3JpYmVyc1t0b3BpY10uc2l6ZSA9PT0gMCkge1xuLy8gICAgICAgZGVsZXRlIHN1YnNjcmliZXJzW3RvcGljXTtcbi8vICAgICAgIGNsaWVudC51bnN1YnNjcmliZSh0b3BpYyk7IC8vIFx1NTk4Mlx1Njc5Q1x1NkNBMVx1NjcwOVx1OEJBMlx1OTYwNVx1ODAwNVx1RkYwQ1x1NTNENlx1NkQ4OFx1OEJBMlx1OTYwNVxuLy8gICAgIH1cbi8vICAgfVxuLy8gfSk7XG5cbi8vIC8vIFx1NUY1MyBNUVRUIFx1NUJBMlx1NjIzN1x1N0FFRlx1NjUzNlx1NTIzMFx1NkQ4OFx1NjA2Rlx1NjVGNlxuLy8gY2xpZW50Lm9uKFwibWVzc2FnZVwiLCAodG9waWMsIG1lc3NhZ2UpID0+IHtcbi8vICAgaWYgKHN1YnNjcmliZXJzW3RvcGljXSkge1xuLy8gICAgIHN1YnNjcmliZXJzW3RvcGljXS5mb3JFYWNoKCh3aW5JZCkgPT4ge1xuLy8gICAgICAgY29uc3Qgd2luID0gQnJvd3NlcldpbmRvdy5mcm9tSWQod2luSWQpO1xuLy8gICAgICAgaWYgKHdpbikge1xuLy8gICAgICAgICB3aW4ud2ViQ29udGVudHMuc2VuZChcIm1lc3NhZ2VcIiwgdG9waWMsIG1lc3NhZ2UudG9TdHJpbmcoKSk7XG4vLyAgICAgICB9XG4vLyAgICAgfSk7XG4vLyAgIH1cbi8vIH0pO1xuXG4vLyAvLyBcdTVGNTMgTVFUVCBcdTVCQTJcdTYyMzdcdTdBRUZcdTY1QURcdTVGMDBcdThGREVcdTYzQTVcdTY1RjZcbi8vIGNsaWVudC5vbihcIm9mZmxpbmVcIiwgKCkgPT4ge1xuLy8gICBjb25zb2xlLmxvZyhcIkRpc2Nvbm5lY3RlZCBmcm9tIE1RVFQgYnJva2VyLlwiKTtcbi8vIH0pO1xuXG4vLyAvLyBcdTVGNTMgTVFUVCBcdTVCQTJcdTYyMzdcdTdBRUZcdTVDMURcdThCRDVcdTkxQ0RcdTY1QjBcdThGREVcdTYzQTVcdTY1RjZcbi8vIGNsaWVudC5vbihcInJlY29ubmVjdFwiLCAoKSA9PiB7XG4vLyAgIGNvbnNvbGUubG9nKFwiUmVjb25uZWN0aW5nIHRvIE1RVFQgYnJva2VyLi4uXCIpO1xuXG4vLyAgIC8vIFx1OTFDRFx1NjVCMFx1OEJBMlx1OTYwNVx1NjI0MFx1NjcwOVx1NEUzQlx1OTg5OFxuLy8gICBmb3IgKGNvbnN0IFt0b3BpYywgY2FsbGJhY2tdIG9mIHRvcGljcy5lbnRyaWVzKCkpIHtcbi8vICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbi8vICAgICAgIGNsaWVudC5zdWJzY3JpYmUodG9waWMpO1xuLy8gICAgIH1cbi8vICAgfVxuLy8gfSk7XG5cbi8vIGltcG9ydCB7XG4vLyAgIGFwcCxcbi8vICAgQnJvd3NlcldpbmRvdyxcbi8vICAgaXBjTWFpblxuLy8gfSBmcm9tIFwiZWxlY3Ryb25cIjtcbi8vIGltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG4vLyBpbXBvcnQgb3MgZnJvbSBcIm9zXCI7XG4vLyBpbXBvcnQgU3RyZWFtIGZyb20gXCJub2RlLXJ0c3Atc3RyZWFtXCI7XG4vLyBpbXBvcnQgbXF0dCBmcm9tIFwibXF0dFwiO1xuLy8gaW1wb3J0IGZzIGZyb20gXCJmc1wiO1xuXG4vLyBjb25zdCBjb25maWcgPSBKU09OLnBhcnNlKFxuLy8gICBmcy5yZWFkRmlsZVN5bmMocGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgXCJjb25maWcuanNvblwiKSwgXCJ1dGY4XCIpXG4vLyApO1xuXG4vLyBjb25zdCBwbGF0Zm9ybSA9IHByb2Nlc3MucGxhdGZvcm0gfHwgb3MucGxhdGZvcm0oKTtcblxuLy8gbGV0IG1haW5XaW5kb3c7XG5cbi8vIGZ1bmN0aW9uIGNyZWF0ZVdpbmRvdygpIHtcbi8vICAgbWFpbldpbmRvdyA9IG5ldyBCcm93c2VyV2luZG93KHtcbi8vICAgICBpY29uOiBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBcImljb25zL2ljb24ucG5nXCIpLFxuLy8gICAgIHdpZHRoOiAxMDAwLFxuLy8gICAgIGhlaWdodDogNjAwLFxuLy8gICAgIGZ1bGxzY3JlZW46IGZhbHNlLFxuLy8gICAgIHVzZUNvbnRlbnRTaXplOiB0cnVlLFxuLy8gICAgIHdlYlByZWZlcmVuY2VzOiB7XG4vLyAgICAgICBjb250ZXh0SXNvbGF0aW9uOiB0cnVlLFxuLy8gICAgICAgcHJlbG9hZDogcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgcHJvY2Vzcy5lbnYuUVVBU0FSX0VMRUNUUk9OX1BSRUxPQUQpLFxuLy8gICAgIH0sXG4vLyAgIH0pO1xuXG4vLyAgIG1haW5XaW5kb3cubG9hZFVSTChwcm9jZXNzLmVudi5BUFBfVVJMKTtcblxuLy8gICBpZiAocHJvY2Vzcy5lbnYuREVCVUdHSU5HKSB7XG4vLyAgICAgbWFpbldpbmRvdy53ZWJDb250ZW50cy5vcGVuRGV2VG9vbHMoKTtcbi8vICAgfSBlbHNlIHtcbi8vICAgICBtYWluV2luZG93LndlYkNvbnRlbnRzLm9uKFwiZGV2dG9vbHMtb3BlbmVkXCIsICgpID0+IHtcbi8vICAgICAgIG1haW5XaW5kb3cud2ViQ29udGVudHMuY2xvc2VEZXZUb29scygpO1xuLy8gICAgIH0pO1xuLy8gICB9XG5cbi8vICAgbWFpbldpbmRvdy5vbihcImNsb3NlZFwiLCAoKSA9PiB7XG4vLyAgICAgbWFpbldpbmRvdyA9IG51bGw7XG4vLyAgIH0pO1xuLy8gfVxuXG4vLyBhcHAud2hlblJlYWR5KCkudGhlbihjcmVhdGVXaW5kb3cpO1xuXG4vLyBhcHAub24oXCJ3aW5kb3ctYWxsLWNsb3NlZFwiLCAoKSA9PiB7XG4vLyAgIGlmIChwbGF0Zm9ybSAhPT0gXCJkYXJ3aW5cIikge1xuLy8gICAgIGFwcC5xdWl0KCk7XG4vLyAgIH1cbi8vIH0pO1xuXG4vLyBhcHAub24oXCJhY3RpdmF0ZVwiLCAoKSA9PiB7XG4vLyAgIGlmIChtYWluV2luZG93ID09PSBudWxsKSB7XG4vLyAgICAgY29uc29sZS5sb2coXCJtYWluV2luZG93IGlzIG51bGxcIik7XG4vLyAgICAgY3JlYXRlV2luZG93KCk7XG4vLyAgIH1cbi8vIH0pO1xuXG4vLyBjb25zdCBydHNwT3BlbmRlcnMgPSB7fTtcbi8vIGxldCBhZGRQb3J0ID0gOTAwMDtcblxuLy8gaXBjTWFpbi5vbihcIm9wZW5SdHNwXCIsIChldmVudCwgcnRzcCkgPT4ge1xuLy8gICBpZiAocnRzcE9wZW5kZXJzW3J0c3BdKSB7XG4vLyAgICAgZXZlbnQucmV0dXJuVmFsdWUgPSB7XG4vLyAgICAgICBjb2RlOiAyMDAsXG4vLyAgICAgICBtc2c6IFwiXHU1RjAwXHU1NDJGXHU2MjEwXHU1MjlGXCIsXG4vLyAgICAgICB3czogcnRzcE9wZW5kZXJzW3J0c3BdLndzLFxuLy8gICAgIH07XG4vLyAgIH0gZWxzZSB7XG4vLyAgICAgYWRkUG9ydCsrO1xuLy8gICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBTdHJlYW0oe1xuLy8gICAgICAgbmFtZTogYHNvY2tldC0ke2FkZFBvcnR9YCxcbi8vICAgICAgIHN0cmVhbVVybDogcnRzcCxcbi8vICAgICAgIHdzUG9ydDogYWRkUG9ydCxcbi8vICAgICAgIGZmbXBlZ09wdGlvbnM6IHtcbi8vICAgICAgICAgXCItc3RhdHNcIjogXCJcIixcbi8vICAgICAgICAgXCItclwiOiAyMCxcbi8vICAgICAgICAgXCItc1wiOiBcIjMyMHgyNDBcIixcbi8vICAgICAgICAgXCItcHJlc2V0XCI6IFwidWx0cmFmYXN0XCIsXG4vLyAgICAgICAgIFwiLXR1bmVcIjogXCJ6ZXJvbGF0ZW5jeVwiLFxuLy8gICAgICAgICBcIi1sb2dsZXZlbFwiOiBcInF1aWV0XCIsXG4vLyAgICAgICAgIFwiLW5vc3RhdHNcIjogXCJcIixcbi8vICAgICAgIH0sXG4vLyAgICAgfSkub24oXCJleGl0V2l0aEVycm9yXCIsICgpID0+IHtcbi8vICAgICAgIHN0cmVhbS5zdG9wKCk7XG4vLyAgICAgICBkZWxldGUgcnRzcE9wZW5kZXJzW3J0c3BdO1xuLy8gICAgICAgZXZlbnQucmV0dXJuVmFsdWUgPSB7XG4vLyAgICAgICAgIGNvZGU6IDQwMCxcbi8vICAgICAgICAgbXNnOiBcIlx1NUYwMFx1NTQyRlx1NTkzMVx1OEQyNVwiLFxuLy8gICAgICAgfTtcbi8vICAgICB9KTtcbi8vICAgICBydHNwT3BlbmRlcnNbcnRzcF0gPSB7XG4vLyAgICAgICB3czogYHdzOi8vbG9jYWxob3N0OiR7YWRkUG9ydH1gLFxuLy8gICAgICAgc3RyZWFtOiBzdHJlYW0sXG4vLyAgICAgfTtcbi8vICAgICBldmVudC5yZXR1cm5WYWx1ZSA9IHtcbi8vICAgICAgIGNvZGU6IDIwMCxcbi8vICAgICAgIG1zZzogXCJcdTVGMDBcdTU0MkZcdTYyMTBcdTUyOUZcIixcbi8vICAgICAgIHdzOiBydHNwT3BlbmRlcnNbcnRzcF0ud3MsXG4vLyAgICAgfTtcbi8vICAgfVxuLy8gfSk7XG5cbi8vIGlwY01haW4ub24oXCJzdG9wUnRzcFwiLCAoZXZlbnQsIHJ0c3ApID0+IHtcbi8vICAgaWYgKHJ0c3BPcGVuZGVyc1tydHNwXSkge1xuLy8gICAgIHJ0c3BPcGVuZGVyc1tydHNwXS5zdHJlYW0uc3RvcCgpO1xuLy8gICAgIGRlbGV0ZSBydHNwT3BlbmRlcnNbcnRzcF07XG4vLyAgIH1cbi8vIH0pO1xuXG4vLyAvLyBcdTVCNThcdTUwQThcdTU5MUFcdTRFMkFNUVRUXHU1QkEyXHU2MjM3XHU3QUVGXHU1QjlFXHU0RjhCXHU1NDhDXHU3NkY4XHU1MTczXHU0RkUxXHU2MDZGXG4vLyBjb25zdCBtcXR0Q2xpZW50cyA9IFtdO1xuXG4vLyAvLyBcdTUyMURcdTU5Q0JcdTUzMTZNUVRUXHU1QkEyXHU2MjM3XHU3QUVGXG4vLyBjb25zdCBpbml0TXF0dENsaWVudHMgPSAoKSA9PiB7XG4vLyAgIGNvbnN0IGJyb2tlcnMgPSBbXCJtcXR0Oi8vMTAuMTAuMC4xOTU6MTg4M1wiLCBcIm1xdHQ6Ly8xMC4xMC4zLjE2OjE4ODNcIl07XG5cbi8vICAgZm9yIChjb25zdCBicm9rZXIgb2YgYnJva2Vycykge1xuLy8gICAgIGNvbnN0IGNsaWVudCA9IG1xdHQuY29ubmVjdChicm9rZXIpO1xuLy8gICAgIG1xdHRDbGllbnRzLnB1c2goe1xuLy8gICAgICAgY2xpZW50LFxuLy8gICAgICAgc3Vic2NyaWJlcnM6IG5ldyBNYXAoKSxcbi8vICAgICB9KTtcblxuLy8gICAgIGNsaWVudC5vbihcImNvbm5lY3RcIiwgKCkgPT4ge1xuLy8gICAgICAgY29uc29sZS5sb2coYENvbm5lY3RlZCB0byBNUVRUIGJyb2tlciBhdCAke2Jyb2tlcn1gKTtcbi8vICAgICAgIC8vIFx1OEJBMlx1OTYwNVx1NjI0MFx1NjcwOVx1NEUzQlx1OTg5OFxuLy8gICAgICAgZm9yIChjb25zdCB7IHRvcGljIH0gb2YgSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgXCJtcXR0LWNvbmZpZy5qc29uXCIpLCBcInV0Zi04XCIpKSkge1xuLy8gICAgICAgICBjbGllbnQuc3Vic2NyaWJlKHRvcGljKTtcbi8vICAgICAgIH1cbi8vICAgICB9KTtcblxuLy8gICAgIGNsaWVudC5vbihcIm1lc3NhZ2VcIiwgKHRvcGljLCBtZXNzYWdlKSA9PiB7XG4vLyAgICAgICBtcXR0Q2xpZW50cy5mb3JFYWNoKCh7IHN1YnNjcmliZXJzIH0pID0+IHtcbi8vICAgICAgICAgaWYgKHN1YnNjcmliZXJzLmhhcyh0b3BpYykpIHtcbi8vICAgICAgICAgICBjb25zdCB3aW5zID0gc3Vic2NyaWJlcnMuZ2V0KHRvcGljKTtcbi8vICAgICAgICAgICB3aW5zLmZvckVhY2god2luSWQgPT4ge1xuLy8gICAgICAgICAgICAgY29uc3Qgd2luID0gQnJvd3NlcldpbmRvdy5mcm9tSWQod2luSWQpO1xuLy8gICAgICAgICAgICAgaWYgKHdpbikge1xuLy8gICAgICAgICAgICAgICB3aW4ud2ViQ29udGVudHMuc2VuZChcIm1lc3NhZ2VcIiwgdG9waWMsIG1lc3NhZ2UudG9TdHJpbmcoKSk7XG4vLyAgICAgICAgICAgICB9XG4vLyAgICAgICAgICAgfSk7XG4vLyAgICAgICAgIH1cbi8vICAgICAgIH0pO1xuLy8gICAgIH0pO1xuXG4vLyAgICAgY2xpZW50Lm9uKFwib2ZmbGluZVwiLCAoKSA9PiB7XG4vLyAgICAgICBjb25zb2xlLmxvZyhgRGlzY29ubmVjdGVkIGZyb20gTVFUVCBicm9rZXIgYXQgJHticm9rZXJ9YCk7XG4vLyAgICAgfSk7XG5cbi8vICAgICBjbGllbnQub24oXCJyZWNvbm5lY3RcIiwgKCkgPT4ge1xuLy8gICAgICAgY29uc29sZS5sb2coYFJlY29ubmVjdGluZyB0byBNUVRUIGJyb2tlciBhdCAke2Jyb2tlcn0uLi5gKTtcbi8vICAgICAgIC8vIFx1OTFDRFx1NjVCMFx1OEJBMlx1OTYwNVx1NjI0MFx1NjcwOVx1NEUzQlx1OTg5OFxuLy8gICAgICAgZm9yIChjb25zdCB7IHRvcGljIH0gb2YgSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgXCJtcXR0LWNvbmZpZy5qc29uXCIpLCBcInV0Zi04XCIpKSkge1xuLy8gICAgICAgICBjbGllbnQuc3Vic2NyaWJlKHRvcGljKTtcbi8vICAgICAgIH1cbi8vICAgICB9KTtcbi8vICAgfVxuLy8gfTtcblxuLy8gaW5pdE1xdHRDbGllbnRzKCk7XG5cbi8vIGlwY01haW4ub24oXCJzdWJzY3JpYmVcIiwgKGV2ZW50LCB0b3BpYykgPT4ge1xuLy8gICBjb25zdCB3aW5JZCA9IGV2ZW50LnNlbmRlci5pZDtcbi8vICAgbXF0dENsaWVudHMuZm9yRWFjaCgoeyBjbGllbnQsIHN1YnNjcmliZXJzIH0pID0+IHtcbi8vICAgICBpZiAoIXN1YnNjcmliZXJzLmhhcyh0b3BpYykpIHtcbi8vICAgICAgIHN1YnNjcmliZXJzLnNldCh0b3BpYywgbmV3IFNldCgpKTtcbi8vICAgICAgIGNsaWVudC5zdWJzY3JpYmUodG9waWMpOyAvLyBcdTc4NkVcdTRGRERcdTZCQ0ZcdTRFMkFcdTVCQTJcdTYyMzdcdTdBRUZcdTkwRkRcdThCQTJcdTk2MDVcbi8vICAgICB9XG4vLyAgICAgc3Vic2NyaWJlcnMuZ2V0KHRvcGljKS5hZGQod2luSWQpO1xuLy8gICB9KTtcbi8vIH0pO1xuXG4vLyBpcGNNYWluLm9uKFwidW5zdWJzY3JpYmVcIiwgKGV2ZW50LCB0b3BpYykgPT4ge1xuLy8gICBjb25zdCB3aW5JZCA9IGV2ZW50LnNlbmRlci5pZDtcbi8vICAgbXF0dENsaWVudHMuZm9yRWFjaCgoeyBjbGllbnQsIHN1YnNjcmliZXJzIH0pID0+IHtcbi8vICAgICBpZiAoc3Vic2NyaWJlcnMuaGFzKHRvcGljKSkge1xuLy8gICAgICAgY29uc3Qgd2lucyA9IHN1YnNjcmliZXJzLmdldCh0b3BpYyk7XG4vLyAgICAgICB3aW5zLmRlbGV0ZSh3aW5JZCk7XG4vLyAgICAgICBpZiAod2lucy5zaXplID09PSAwKSB7XG4vLyAgICAgICAgIHN1YnNjcmliZXJzLmRlbGV0ZSh0b3BpYyk7XG4vLyAgICAgICAgIGNsaWVudC51bnN1YnNjcmliZSh0b3BpYyk7IC8vIFx1NTk4Mlx1Njc5Q1x1NkNBMVx1NjcwOVx1OEJBMlx1OTYwNVx1ODAwNVx1RkYwQ1x1NTNENlx1NkQ4OFx1OEJBMlx1OTYwNVxuLy8gICAgICAgfVxuLy8gICAgIH1cbi8vICAgfSk7XG4vLyB9KTtcblxuaW1wb3J0IHtcbiAgYXBwLFxuICBCcm93c2VyV2luZG93LFxuICBpcGNNYWluXG59IGZyb20gXCJlbGVjdHJvblwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCBvcyBmcm9tIFwib3NcIjtcbmltcG9ydCBTdHJlYW0gZnJvbSBcIm5vZGUtcnRzcC1zdHJlYW1cIjtcbmltcG9ydCBtcXR0IGZyb20gXCJtcXR0XCI7XG5pbXBvcnQgZnMgZnJvbSBcImZzXCI7XG5cbi8vIGNvbnN0IGNvbmZpZyA9IEpTT04ucGFyc2UoXG4vLyAgIGZzLnJlYWRGaWxlU3luYyhwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBcImNvbmZpZy5qc29uXCIpLCBcInV0ZjhcIilcbi8vICk7XG5cbmNvbnN0IHBsYXRmb3JtID0gcHJvY2Vzcy5wbGF0Zm9ybSB8fCBvcy5wbGF0Zm9ybSgpO1xuXG5sZXQgbWFpbldpbmRvdztcblxuZnVuY3Rpb24gY3JlYXRlV2luZG93KCkge1xuICBtYWluV2luZG93ID0gbmV3IEJyb3dzZXJXaW5kb3coe1xuICAgIGljb246IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsIFwiaWNvbnMvaWNvbi5wbmdcIiksXG4gICAgd2lkdGg6IDEwMDAsXG4gICAgaGVpZ2h0OiA2MDAsXG4gICAgZnVsbHNjcmVlbjogZmFsc2UsXG4gICAgdXNlQ29udGVudFNpemU6IHRydWUsXG4gICAgd2ViUHJlZmVyZW5jZXM6IHtcbiAgICAgIGNvbnRleHRJc29sYXRpb246IHRydWUsXG4gICAgICBwcmVsb2FkOiBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBwcm9jZXNzLmVudi5RVUFTQVJfRUxFQ1RST05fUFJFTE9BRCksXG4gICAgfSxcbiAgfSk7XG5cbiAgbWFpbldpbmRvdy5sb2FkVVJMKHByb2Nlc3MuZW52LkFQUF9VUkwpO1xuXG4gIGlmIChwcm9jZXNzLmVudi5ERUJVR0dJTkcpIHtcbiAgICBtYWluV2luZG93LndlYkNvbnRlbnRzLm9wZW5EZXZUb29scygpO1xuICB9IGVsc2Uge1xuICAgIG1haW5XaW5kb3cud2ViQ29udGVudHMub24oXCJkZXZ0b29scy1vcGVuZWRcIiwgKCkgPT4ge1xuICAgICAgbWFpbldpbmRvdy53ZWJDb250ZW50cy5jbG9zZURldlRvb2xzKCk7XG4gICAgfSk7XG4gIH1cblxuICBtYWluV2luZG93Lm9uKFwiY2xvc2VkXCIsICgpID0+IHtcbiAgICBtYWluV2luZG93ID0gbnVsbDtcbiAgfSk7XG59XG5cbmFwcC53aGVuUmVhZHkoKS50aGVuKGNyZWF0ZVdpbmRvdyk7XG5cbmFwcC5vbihcIndpbmRvdy1hbGwtY2xvc2VkXCIsICgpID0+IHtcbiAgaWYgKHBsYXRmb3JtICE9PSBcImRhcndpblwiKSB7XG4gICAgYXBwLnF1aXQoKTtcbiAgfVxufSk7XG5cbmFwcC5vbihcImFjdGl2YXRlXCIsICgpID0+IHtcbiAgaWYgKG1haW5XaW5kb3cgPT09IG51bGwpIHtcbiAgICBjb25zb2xlLmxvZyhcIm1haW5XaW5kb3cgaXMgbnVsbFwiKTtcbiAgICBjcmVhdGVXaW5kb3coKTtcbiAgfVxufSk7XG5cbmNvbnN0IHJ0c3BPcGVuZGVycyA9IHt9O1xubGV0IGFkZFBvcnQgPSA5MDAwO1xuXG5pcGNNYWluLm9uKFwib3BlblJ0c3BcIiwgKGV2ZW50LCBydHNwKSA9PiB7XG4gIGlmIChydHNwT3BlbmRlcnNbcnRzcF0pIHtcbiAgICBldmVudC5yZXR1cm5WYWx1ZSA9IHtcbiAgICAgIGNvZGU6IDIwMCxcbiAgICAgIG1zZzogXCJcdTVGMDBcdTU0MkZcdTYyMTBcdTUyOUZcIixcbiAgICAgIHdzOiBydHNwT3BlbmRlcnNbcnRzcF0ud3MsXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBhZGRQb3J0Kys7XG4gICAgY29uc3Qgc3RyZWFtID0gbmV3IFN0cmVhbSh7XG4gICAgICBuYW1lOiBgc29ja2V0LSR7YWRkUG9ydH1gLFxuICAgICAgc3RyZWFtVXJsOiBydHNwLFxuICAgICAgd3NQb3J0OiBhZGRQb3J0LFxuICAgICAgZmZtcGVnT3B0aW9uczoge1xuICAgICAgICBcIi1zdGF0c1wiOiBcIlwiLFxuICAgICAgICBcIi1yXCI6IDIwLFxuICAgICAgICBcIi1zXCI6IFwiNjQweDQ4MFwiLFxuICAgICAgICBcIi1wcmVzZXRcIjogXCJ1bHRyYWZhc3RcIixcbiAgICAgICAgXCItdHVuZVwiOiBcInplcm9sYXRlbmN5XCIsXG4gICAgICAgIFwiLWxvZ2xldmVsXCI6IFwicXVpZXRcIixcbiAgICAgICAgXCItbm9zdGF0c1wiOiBcIlwiLFxuICAgICAgfSxcbiAgICB9KS5vbihcImV4aXRXaXRoRXJyb3JcIiwgKCkgPT4ge1xuICAgICAgc3RyZWFtLnN0b3AoKTtcbiAgICAgIGRlbGV0ZSBydHNwT3BlbmRlcnNbcnRzcF07XG4gICAgICBldmVudC5yZXR1cm5WYWx1ZSA9IHtcbiAgICAgICAgY29kZTogNDAwLFxuICAgICAgICBtc2c6IFwiXHU1RjAwXHU1NDJGXHU1OTMxXHU4RDI1XCIsXG4gICAgICB9O1xuICAgIH0pO1xuICAgIHJ0c3BPcGVuZGVyc1tydHNwXSA9IHtcbiAgICAgIHdzOiBgd3M6Ly9sb2NhbGhvc3Q6JHthZGRQb3J0fWAsXG4gICAgICBzdHJlYW06IHN0cmVhbSxcbiAgICB9O1xuICAgIGV2ZW50LnJldHVyblZhbHVlID0ge1xuICAgICAgY29kZTogMjAwLFxuICAgICAgbXNnOiBcIlx1NUYwMFx1NTQyRlx1NjIxMFx1NTI5RlwiLFxuICAgICAgd3M6IHJ0c3BPcGVuZGVyc1tydHNwXS53cyxcbiAgICB9O1xuICB9XG59KTtcblxuaXBjTWFpbi5vbihcInN0b3BSdHNwXCIsIChldmVudCwgcnRzcCkgPT4ge1xuICBpZiAocnRzcE9wZW5kZXJzW3J0c3BdKSB7XG4gICAgcnRzcE9wZW5kZXJzW3J0c3BdLnN0cmVhbS5zdG9wKCk7XG4gICAgZGVsZXRlIHJ0c3BPcGVuZGVyc1tydHNwXTtcbiAgfVxufSk7XG5cbi8vIFx1NUI1OFx1NTBBOFx1NTkxQVx1NEUyQU1RVFRcdTVCQTJcdTYyMzdcdTdBRUZcdTVCOUVcdTRGOEJcdTU0OENcdTc2RjhcdTUxNzNcdTRGRTFcdTYwNkZcbmNvbnN0IG1xdHRDbGllbnRzID0gW107XG5jb25zdCBnbG9iYWxTdWJzY3JpYmVycyA9IG5ldyBNYXAoKTtcblxuLy8gXHU1MjFEXHU1OUNCXHU1MzE2TVFUVFx1NUJBMlx1NjIzN1x1N0FFRlxuY29uc3QgaW5pdE1xdHRDbGllbnRzID0gKCkgPT4ge1xuICBjb25zdCBicm9rZXJzID0gW1wibXF0dDovLzEwLjEwLjAuMTk1OjE4ODNcIiwgXCJtcXR0Oi8vMTAuMTAuMy4xNjoxODgzXCJdO1xuXG4gIGZvciAoY29uc3QgYnJva2VyIG9mIGJyb2tlcnMpIHtcbiAgICBjb25zdCBjbGllbnQgPSBtcXR0LmNvbm5lY3QoYnJva2VyKTtcbiAgICBtcXR0Q2xpZW50cy5wdXNoKGNsaWVudCk7XG5cbiAgICBjbGllbnQub24oXCJjb25uZWN0XCIsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBDb25uZWN0ZWQgdG8gTVFUVCBicm9rZXIgYXQgJHticm9rZXJ9YCk7XG4gICAgICAvLyBcdThCQTJcdTk2MDVcdTUxNjhcdTVDNDBcdTYyNDBcdTY3MDlcdTRFM0JcdTk4OThcbiAgICAgIGdsb2JhbFN1YnNjcmliZXJzLmZvckVhY2goKF8sIHRvcGljKSA9PiB7XG4gICAgICAgIGNsaWVudC5zdWJzY3JpYmUodG9waWMpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBjbGllbnQub24oXCJtZXNzYWdlXCIsICh0b3BpYywgbWVzc2FnZSkgPT4ge1xuICAgICAgaWYgKCFtZXNzYWdlKSByZXR1cm47IC8vIFx1Nzg2RVx1NEZERFx1NkQ4OFx1NjA2Rlx1NjcwOVx1NjU0OFxuICAgICAgY29uc3Qgc3Vic2NyaWJlcnMgPSBnbG9iYWxTdWJzY3JpYmVycy5nZXQodG9waWMpO1xuICAgICAgaWYgKHN1YnNjcmliZXJzKSB7XG4gICAgICAgIHN1YnNjcmliZXJzLmZvckVhY2god2luSWQgPT4ge1xuICAgICAgICAgIGNvbnN0IHdpbiA9IEJyb3dzZXJXaW5kb3cuZnJvbUlkKHdpbklkKTtcbiAgICAgICAgICBpZiAod2luKSB7XG4gICAgICAgICAgICB3aW4ud2ViQ29udGVudHMuc2VuZChcIm1lc3NhZ2VcIiwgdG9waWMsIG1lc3NhZ2UudG9TdHJpbmcoKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNsaWVudC5vbihcIm9mZmxpbmVcIiwgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coYERpc2Nvbm5lY3RlZCBmcm9tIE1RVFQgYnJva2VyIGF0ICR7YnJva2VyfWApO1xuICAgIH0pO1xuXG4gICAgY2xpZW50Lm9uKFwicmVjb25uZWN0XCIsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBSZWNvbm5lY3RpbmcgdG8gTVFUVCBicm9rZXIgYXQgJHticm9rZXJ9Li4uYCk7XG4gICAgICAvLyBcdTkxQ0RcdTY1QjBcdThCQTJcdTk2MDVcdTYyNDBcdTY3MDlcdTRFM0JcdTk4OThcbiAgICAgIGdsb2JhbFN1YnNjcmliZXJzLmZvckVhY2goKF8sIHRvcGljKSA9PiB7XG4gICAgICAgIGNsaWVudC5zdWJzY3JpYmUodG9waWMpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn07XG5cbmluaXRNcXR0Q2xpZW50cygpO1xuXG5pcGNNYWluLm9uKFwic3Vic2NyaWJlXCIsIChldmVudCwgdG9waWMpID0+IHtcbiAgY29uc3Qgd2luSWQgPSBldmVudC5zZW5kZXIuaWQ7XG4gIGlmICghZ2xvYmFsU3Vic2NyaWJlcnMuaGFzKHRvcGljKSkge1xuICAgIGdsb2JhbFN1YnNjcmliZXJzLnNldCh0b3BpYywgbmV3IFNldCgpKTtcbiAgICBtcXR0Q2xpZW50cy5mb3JFYWNoKGNsaWVudCA9PiBjbGllbnQuc3Vic2NyaWJlKHRvcGljKSk7XG4gIH1cbiAgZ2xvYmFsU3Vic2NyaWJlcnMuZ2V0KHRvcGljKS5hZGQod2luSWQpO1xufSk7XG5cbmlwY01haW4ub24oXCJ1bnN1YnNjcmliZVwiLCAoZXZlbnQsIHRvcGljKSA9PiB7XG4gIGNvbnN0IHdpbklkID0gZXZlbnQuc2VuZGVyLmlkO1xuICBpZiAoZ2xvYmFsU3Vic2NyaWJlcnMuaGFzKHRvcGljKSkge1xuICAgIGNvbnN0IHN1YnNjcmliZXJzID0gZ2xvYmFsU3Vic2NyaWJlcnMuZ2V0KHRvcGljKTtcbiAgICBzdWJzY3JpYmVycy5kZWxldGUod2luSWQpO1xuICAgIGlmIChzdWJzY3JpYmVycy5zaXplID09PSAwKSB7XG4gICAgICBnbG9iYWxTdWJzY3JpYmVycy5kZWxldGUodG9waWMpO1xuICAgICAgbXF0dENsaWVudHMuZm9yRWFjaChjbGllbnQgPT4gY2xpZW50LnVuc3Vic2NyaWJlKHRvcGljKSk7XG4gICAgfVxuICB9XG59KTtcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBcVpBLHNCQUlPO0FBQ1Asa0JBQWlCO0FBQ2pCLGdCQUFlO0FBQ2YsOEJBQW1CO0FBQ25CLGtCQUFpQjtBQU9qQixJQUFNLFdBQVcsUUFBUSxZQUFZLFVBQUFBLFFBQUcsU0FBUztBQUVqRCxJQUFJO0FBRUosU0FBUyxlQUFlO0FBQ3RCLGVBQWEsSUFBSSw4QkFBYztBQUFBLElBQzdCLE1BQU0sWUFBQUMsUUFBSyxRQUFRLFdBQVcsZ0JBQWdCO0FBQUEsSUFDOUMsT0FBTztBQUFBLElBQ1AsUUFBUTtBQUFBLElBQ1IsWUFBWTtBQUFBLElBQ1osZ0JBQWdCO0FBQUEsSUFDaEIsZ0JBQWdCO0FBQUEsTUFDZCxrQkFBa0I7QUFBQSxNQUNsQixTQUFTLFlBQUFBLFFBQUssUUFBUSxXQUFXLDJFQUFtQztBQUFBLElBQ3RFO0FBQUEsRUFDRixDQUFDO0FBRUQsYUFBVyxRQUFR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
